<include file="Public:header" />
<style type="text/css"> table {font-size: 12px} </style>
<div class="pad-lr-10">
    <div class="data_top">
        <a class="cat" href="javascript:addExcel()">excel表格导入</a>
        <a class="cat" href="javascript:addTwo()">添加二级目录</a>
    </div>
    <form name="searchform" id="searchform" action="admin.php?m={$controller}&a=two" method="get" >
        <table width="100%" cellspacing="0" class="search-form">
            <tbody>
            <tr>
                <td>
                    <div class="explain-col">
                        &nbsp;目录名称 :
                        <input name="keyword" id="keyword" type="text" class="input-text" size="25" value="{$keyword}" />
                        &nbsp;&nbsp;&nbsp;&nbsp;年级 :
                        <select name="grade_id" id="grade_id">
                            <option value="">请选择</option>
                            <volist name="grade_list" id="val">
                                <option value="{$val.id}" <if condition="$grade_id eq $val['id']">selected="selected"</if>>{$val.name}</option>
                            </volist>
                        </select>
                        &nbsp;&nbsp;&nbsp;&nbsp;学科 :
                        <select name="cate_id" id="cate_id">
                            <option value="">请选择</option>
                            <volist name="cate_list" id="val">
                                <option value="{$val.id}" <if condition="$cate_id eq $val['id']">selected="selected"</if>>{$val.name}</option>
                            </volist>
                        </select>
                        &nbsp;&nbsp;&nbsp;&nbsp;状态 :
                        <select name="status" id="status">
                            <option value="2" <if condition="$status eq 2">selected="selected"</if>>请选择</option>
                            <option value="1" <if condition="$status eq 1">selected="selected"</if>>有效</option>
                            <option value="0" <if condition="$status eq 0">selected="selected"</if>>无效</option>
                        </select>
                        &nbsp;&nbsp;
                        <input type="hidden" name="m" value="{$controller}" />
                        <input type="hidden" name="a" value="two" />
                        <input type="submit" name="search" class="button" value="搜索" />
                        <input type="button" class="button" value="重置" onclick="clean()"/>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
    </form>
    <form id="myform" name="myform" action="admin.php?m={$controller}&a=delete" method="post" onsubmit="return checkTwo();">
        <div class="table-list">
            <table width="100%" cellspacing="0">
                <thead>
                <tr>
                    <th width=50>ID</th>
                    <th width=30><input type="checkbox" value="" id="check_box" onclick="selectall('id[]');"></th>
                    <th>年级</th>
                    <th>学科</th>
                    <th>编号</th>
                    <th>一级目录</th>
                    <th>编号</th>
                    <th>二级目录</th>
                    <th>状态</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody>
                <volist name="point_list" id="val" key="k" >
                    <tr>
                        <td align="center">{$val.id}</td>
                        <td align="center"><input type="checkbox" value="{$val.id}" name="id[]"></td>
                        <td align="center">{$val.grade}</td>
                        <td align="center">{$val.cate}</td>
                        <td align="center">{$val.alias1}</td>
                        <td align="center">{$val.name1}</td>
                        <td align="center">{$val.alias}</td>
                        <td align="center">{$val.name}</td>
                        <!--<td align="center"><input type="text" class="input-text-c input-text" onblur="sort({$val.id},'sort',this.value)" id="sort_{$val.id}" value="{$val.sort}" size="4" name="listorders[{$val.id}]"></td>-->
                        <td align="center" onclick="statusTwo({$val.id},'status')" id="status_{$val.id}"><img src="__ROOT__/statics/images/status_{$val.status}.gif" /></td>
                        <td align="center"><a href="javascript:editTwo({$val.id})"><span style="color:blue;">编辑</span></a></td>
                    </tr>
                </volist>
                </tbody>
            </table>
            <div class="btn">
                <label for="check_box" style="float:left;">{$Think.lang.select_all}/{$Think.lang.cancel}</label>
                <input type="submit" class="button" name="dosubmit" value="{$Think.lang.delete}" onclick="return confirm('确认删除该目录，及其所有子目录吗？（请注意，删除后无法恢复！）')" style="float:left;margin-left:10px;"/>
                <div id="pages">{$page}</div>
            </div>
        </div>
    </form>
</div>
<script language="javascript">
    function checkTwo(){
        var ids='';
        $("input[name='id[]']:checked").each(function(i, n){
            ids += $(n).val() + ',';
        });
        if(ids=='') {
            window.top.art.dialog({content:lang_please_select+'菜单分类名称	',lock:true,width:'200',height:'50',time:1.5},function(){});
            return false;
        }
        return true;
    }
    //添加二级目录
    function addTwo() {
        var lang_add = "添加二级目录";
        window.top.art.dialog({id:'addTwo'}).close();
        window.top.art.dialog({
                    title:lang_add,
                    id:'addTwo',
                    iframe:"?m={$controller}&a=addTwo",width:'480',height:'170'
                },
                function()
                {
                    var d = window.top.art.dialog({id:'addTwo'}).data.iframe;
                    var form=d.document.getElementById('dosubmit').click();
                    form.click();return false;

                },
                function()
                {
                    window.top.art.dialog({id:'addTwo'}).close()
                });

    }
    //知识点excel表格导入
    function addExcel() {
        window.top.art.dialog({id:'addExcel'}).close();
        window.top.art.dialog({
                    title:'excel表格导入',
                    id:'addExcel',
                    iframe:"?m={$controller}&a=addExcel&level=Two",width:'400',height:'150'
                },
                function()
                {
                    var d = window.top.art.dialog({id:'addExcel'}).data.iframe;
                    var form=d.document.getElementById('dosubmit').click();
                    form.click();return false;

                },
                function()
                {
                    window.top.art.dialog({id:'addExcel'}).close()
                });

    }
    function editTwo(id) {
        var lang_edit = '编辑二级目录';
        window.top.art.dialog({id:'editTwo'}).close();
        window.top.art.dialog({
                    title:lang_edit,
                    id:'editTwo',
                    iframe:"?m={$controller}&a=editTwo&id="+id,width:'510',height:'260'
                },
                function()
                {
                    var d = window.top.art.dialog({id:'editTwo'}).data.iframe;
                    d.document.getElementById('dosubmit').click();
                    return false;
                },
                function()
                {
                    window.top.art.dialog({id:'editTwo'}).close()
                });
    }
    function statusTwo(id,type){
        var url = "admin.php?m={$controller}&a=status";
        $.get(url, { id: id, type: type }, function(jsondata){
            var return_data  = eval("("+jsondata+")");
            $("#"+type+"_"+id+" img").attr('src', '__ROOT__/statics/images/status_'+return_data+'.gif');
        });
    }
    //重置
    function clean(){
        $("#keyword").val('');
        $("#grade_id").val('');
        $("#cate_id").val('');
        $("#status").val('');
        $("#searchform").submit();
    }
</script>
</body>
</html>